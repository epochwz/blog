# 用户和用户组管理

**用户：**使用操作系统的人，Linux系统允许多个用户同时登录同一个系统

**用户组：**具有相同系统权限的一组用户，Linux系统允许存在多个用户组

**查看登录用户的信息**

```
# 查看系统当前登录用户的详细/简单信息
$ w/who
    USER       用户名
    TTY        登录终端
    FROM       登录IP
    LOGIN@     登录时间
    IDLE       用户闲置时间
    JCPU       该连接终端的所有进程占用的时间(包括后台作业)
    PCPU       当前进程所占用的时间
    WHAT       当前正在运行的命令

# 查询当前和过去登录用户的信息(默认读取/var/log/wtmp文件的数据)
$ last
# 查询所有用户的最后登录时间(默认读取/var/log/lastlog)
$ lastlog
```

**用户的配置文件**

```
/etc/passwd    存储系统中所有用户的信息
用户名    密码占位符    用户编号    用户组编号    用户注释信息    用户主目录    Shell类型
user:    x:          123:       456:        xxxxxx        /home/user   /bin/bash
/etc/shadow    存储系统中所有用户的密码信息

root的用户编号一定是0
```

**用户组的配置文件**

```
/etc/group    存储系统中所有用户组的信息
组名称    组密码占位符    组编号    组中用户名列表
Group:   x:            123:     abc,def,xyz

/etc/gshadow    存储系统所有用户组的密码信息
组名称    组密码         组管理者  组中用户名列表
Group:   *:            :        abc,def,xyz

系统创建的用户组编号1-500 || 用户创建的用户组编号501+
```

**用户组管理命令**

```
# 添加用户组
$ groupadd groupName
# 修改用户组名称
$ groupmod -n newName oldName
# 修改组编号
$ groupmod -g groupID groupName
# 删除用户组
$ groupdel groupName
```

**用户管理命令**

```
# 默认创建与用户名相同的用户组
# 默认主目录/home/userName
$ useradd userName

# 创建用户并指定用户主目录
$ useradd -d /path/userName

# 修改用户注释信息
$ usermod -c comment userName
# 修改用户名称
$ usermod -l newName userName
# 修改用户的用户组
$ usermod -g userName userName
# 删除用户及其主目录
$ userdel -r userName
```

**其他用户管理命令**

```
# 禁止root以外的账户登录服务器
$ touch /etc/nologin
# 锁定用户
$ passwd -l userName
# 解锁用户
$ passwd -u userName
# 清除密码:允许用户无密码登录
$ passwd -d userName


# 切换用户，默认root
$ su [userName]
# 显示用户信息(用户编号/名称、组编号/名称、附属组列表)，默认当前用户
$ id [userName]
# 显示用户所在的所有组
$ groups userName

# 设置用户资料
$ chifn userName
# 显示用户详细资料
$ finger userName
```

**主要组**和**附属组**

```
用户可以同时属于一个主要组和多个附属组

# 创建用户并指定 主目录、主要组、附属组
$ useradd -d /home/userName -g groupName -G group1,group2,... userName

# 添加用户到附属组
$ gpasswd -a userName group1,group2....
# 设置组密码
$ gpasswd groupName
# 临时切换到附属组身份(需要组密码)
$ newgrp group1/group2/....
# 删除附属组
$ gpasswd -d userName groupName
```