RowSet是默认可滚动、可更新、可序列化的结果集，可直接作为JavaBean使用，方便在网络上传输，用于同步两端数据。

RowSet接口继承了ResultSet接口，包含以下子接口
- JdbcRowSet：需要保持与数据库的连接
- CachedRowSet[及其子接口FilteredRowSet/JoinRowSet/WebRowSet]：离线RowSet,无须保持与数据库的连接

![RowSet规范的接口类图][]

## 13.5.1 RowSetProvider与RowSetFactory
- JDK1.6以前，并没有为RowSet及其子接口提供实现类，也没有提供公开的方法来创建RowSet及其子接口的实例。
- JDK1.6，提供了RowSet五个子接口对应的实现类:JdbcRowSetImpl,CachedRowSetImpl,WebRowSetImpl,FilteredRowSetImpl,JoinRowSetImpl.
    - 程序直接与XxxRowSetImpl耦合，不利于后期升级扩展
    - XxxRowSetImpl实现类不是公开的API，未来可能被删除
- JDK1.7,提供RowSetProvider负责创建RowSetFactory,RowSetFactory负责创建RowSet实例。
    - 通过使用RowSetFactory,把应用程序与RowSet实现类分离，避免直接使用非公开API，有利于程序升级扩展

创建可滚动、可更新的RowSet的步骤：
1. 加载驱动:`Class.forName(driver);`
2. 使用RowSetProvider创建RowSetFactory:`RowSetFactory factory = RowSetProvider.newFactory();`
3. 使用RowSetFactory创建默认的JdbcRowSet实例:`JdbcRowSet jrs = factory.createJdbcRowSet())`
4. 设置Connection参数:`jrs.setUrl(url);jrs.setUsername(user);jrs.setPassword(pass);`
5. 设置SQL查询语句:`jrs.setCommand(sql);`
6. 执行查询:`jrs.execute();`
7. 操作结果集jrs[滚动、更新，类似ResultSet]

## 13.5.2 离线RowSet
ResultSet：程序查询得到ResultSet后必须立即读取或处理它对应的记录，否则Connection一旦关闭，就无法通过它读取记录了。

应用程序架构分为两层:数据访问层和视图显示层，当程序在数据访问层取得ResultSet后，有两种处理方式:
- 迭代访问结果集中的记录，并转换成JavaBean，再将多个JavaBean封装成一个List集合[ResultSet->JavaBean集合 的转换]，转换完成后可以关闭Connection资源，将集合传到视图显示层。
- 直接将ResultSet传到视图显示层--要求显示数据时，Connection必须一直处于打开状态，否则无法读取记录。

第一种安全但繁琐；第二种不安全且性能低。

离线RowSet：程序直接将底层数据读入内存，封装成离线RowSet对象[可以当成JavaBean使用]可以充分利用计算机内存降低数据库服务器的负载，提高程序性能。安全且简单。

创建离线RowSet[示例:CachedRowSet]的步骤:
1. 获取ResultSet
2. 获取RowSetFactory
3. 创建CachedRowSet实例:`CachedRowSet crs=factory.createCachedRowSet();`
4. 封装ResultSet成CachedRowSet:`crs.populate(rs);`
5. 操作crs[滚动、更新,类似RowSet]
6. 同步crs的修改到底层数据库:
    1. 重新获取数据库连接
    2. 开启事务[关闭自动提交]:`conn.setAutoCommit(false);`
    3. 提交修改:`crs.acceptChanges(conn);`

## 13.5.3 离线RowSet的查询分页
离线RowSet会将数据记录直接装载到内存中，若查询返回的记录过大，将占用大量内存，甚至导致内存溢出。

因此离线RowSet提供分页功能:一次只装载ResultSet里的某几条记录
1. `crs.populate(rs,int startRow);`
2. setPageSize(int pageSize):设置CachedRowSet每次返回多少条记录
3. previousPage():底层ResultSet可用情况下，读取上一页记录
4. nextPage():底层ResultSet可用情况下，读取下一页记录

[RowSet规范的接口类图]:http://note.youdao.com/yws/public/resource/19cc8a2d6058bd78bb4dc157fb70ad26/xmlnote/4C29FE43A59F477BAA8741385DA95C8C/6047 "RowSet规范的接口类图"